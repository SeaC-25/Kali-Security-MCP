# 渗透测试命令

**用法**: `/pentest $ARGUMENTS`
**参数**: `TARGET [MODE]` - 目标IP/域名/网段，模式(quick/comprehensive/stealth)

---

## 执行流程

根据提供的参数 `$ARGUMENTS` 执行渗透测试：

### 1. 确认授权
首先确认用户已获得对目标的测试授权。

### 2. 解析参数
- 从 `$ARGUMENTS` 中提取 TARGET 和 MODE
- 默认 MODE = comprehensive

### 3. 开始攻击会话
```
start_attack_session(target=TARGET, mode="apt")
```

### 4. 根据模式选择测试策略

**快速模式** (mode=quick, 约15分钟):
```
# 快速端口扫描
nmap_scan(target=TARGET, scan_type="-sV -T4", ports="21,22,80,443,3306,8080")

# 快速Web扫描
gobuster_scan(url=f"http://{TARGET}", time_constraint="quick")

# 快速漏洞检测
nuclei_scan(target=TARGET, severity="critical,high")
```

**全面模式** (mode=comprehensive, 约60分钟):
```
# 全面网络侦察
comprehensive_network_scan(target=TARGET, deep_scan=True)

# 全面Web安全评估
advanced_web_security_assessment(target=f"http://{TARGET}")

# 智能漏洞评估
intelligent_vulnerability_assessment(target=TARGET, assessment_depth="comprehensive")

# 网络渗透测试
network_penetration_test(target=TARGET, scope="single")
```

**隐蔽模式** (mode=stealth):
```
# 低速隐蔽扫描
nmap_scan(target=TARGET, scan_type="-sS -T2", stealth_mode=True)

# 被动信息收集
theharvester_osint(domain=TARGET)

# 隐蔽Web扫描
gobuster_scan(url=f"http://{TARGET}", stealth_mode=True)
```

### 5. 记录发现
每个工具执行后使用 `log_attack_step()` 记录结果。

### 6. 生成报告
```
generate_poc_from_current_session()
end_attack_session()
```

---

## 报告内容

- 执行摘要
- 发现的漏洞列表（按CVSS评分排序）
- 攻击路径图
- 详细技术发现
- 修复建议
- PoC代码

---

## 示例

- `/pentest 192.168.1.100` - 全面测试单个主机
- `/pentest 10.0.0.0/24 quick` - 快速扫描整个网段
- `/pentest target.com stealth` - 隐蔽模式测试域名
